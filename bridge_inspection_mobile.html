<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bridge Safety Inspection App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8fafc;
            color: #1a202c;
            line-height: 1.5;
        }

        .phone-container {
            max-width: 375px;
            margin: 20px auto;
            background: #000;
            border-radius: 25px;
            padding: 10px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }

        .phone-screen {
            background: #fff;
            border-radius: 20px;
            overflow: hidden;
            height: 812px;
            position: relative;
        }

        .status-bar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 20px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            font-weight: 600;
        }

        .app-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .app-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .app-subtitle {
            font-size: 12px;
            opacity: 0.9;
        }

        .bridge-info-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 250, 252, 0.95));
            margin: 16px;
            border-radius: 16px;
            padding: 16px;
            border: 1px solid rgba(226, 232, 240, 0.5);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .bridge-name {
            font-size: 16px;
            font-weight: 700;
            color: #1a202c;
            margin-bottom: 8px;
        }

        .bridge-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            font-size: 12px;
            color: #64748b;
        }

        .gps-status {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-top: 12px;
            padding: 8px 12px;
            background: rgba(34, 197, 94, 0.1);
            border-radius: 8px;
            font-size: 12px;
            color: #166534;
        }

        .gps-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .form-container {
            flex: 1;
            overflow-y: auto;
            padding: 0 16px 100px;
        }

        .section {
            margin-bottom: 24px;
        }

        .section-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 16px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: #374151;
            font-size: 14px;
            margin-bottom: 6px;
        }

        .required {
            color: #ef4444;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 8px;
        }

        .radio-option {
            flex: 1;
            min-width: 80px;
        }

        .radio-input {
            display: none;
        }

        .radio-label {
            display: block;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .radio-input:checked + .radio-label {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .checkbox-group {
            display: grid;
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .checkbox-item:hover {
            background: #f8fafc;
        }

        .checkbox-item input:checked + label {
            color: #667eea;
            font-weight: 600;
        }

        .image-capture-area {
            border: 2px dashed #d1d5db;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            background: #f8fafc;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .image-capture-area:hover {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.05);
        }

        .capture-icon {
            font-size: 32px;
            margin-bottom: 8px;
            color: #667eea;
        }

        .capture-text {
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }

        .capture-hint {
            font-size: 12px;
            color: #94a3b8;
            margin-top: 4px;
        }

        .captured-images {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 12px;
        }

        .captured-image {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #64748b;
        }

        .remove-image {
            position: absolute;
            top: 4px;
            right: 4px;
            background: rgba(239, 68, 68, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
        }

        .measurement-group {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 8px;
            align-items: end;
        }

        .unit-label {
            padding: 12px 8px;
            background: #f1f5f9;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            color: #475569;
        }

        .bottom-actions {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 375px;
            background: white;
            padding: 16px 20px;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 12px;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #f8fafc;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .progress-bar {
            height: 4px;
            background: #e5e7eb;
            border-radius: 2px;
            overflow: hidden;
            margin: 16px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 2px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            font-size: 12px;
            color: #64748b;
            margin-bottom: 8px;
        }

        .offline-indicator {
            background: rgba(239, 68, 68, 0.1);
            color: #991b1b;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            text-align: center;
            margin: 16px;
            display: none;
        }

        .warning-alert {
            background: rgba(251, 191, 36, 0.1);
            border: 1px solid rgba(251, 191, 36, 0.3);
            color: #92400e;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            margin-bottom: 16px;
        }

        .success-alert {
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.3);
            color: #166534;
            padding: 12px;
            border-radius: 8px;
            font-size: 12px;
            margin-bottom: 16px;
        }

        .signature-pad {
            border: 1px solid #d1d5db;
            border-radius: 8px;
            background: white;
            cursor: crosshair;
        }

        .tab-navigation {
            display: flex;
            background: #f8fafc;
            border-radius: 12px;
            padding: 4px;
            margin: 16px;
            gap: 4px;
        }

        .tab-button {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-button.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .photo-requirement {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
            color: #64748b;
            margin-bottom: 8px;
        }

        .requirement-icon {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #ef4444;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }

        .requirement-icon.completed {
            background: #22c55e;
        }
    </style>
</head>
<body>
    <div class="phone-container">
        <div class="phone-screen">
            <!-- Status Bar -->
            <div class="status-bar">
                <span>9:41 AM</span>
                <span>📶 🔋 100%</span>
            </div>

            <!-- App Header -->
            <div class="app-header">
                <div class="app-title">Bridge Safety Inspection</div>
                <div class="app-subtitle">State Road Construction Department</div>
            </div>

            <!-- Bridge Info Card -->
            <div class="bridge-info-card">
                <div class="bridge-name">NH-44 Highway Bridge</div>
                <div class="bridge-details">
                    <div><strong>ID:</strong> BRG-001</div>
                    <div><strong>Type:</strong> Highway Bridge</div>
                    <div><strong>Built:</strong> 2018</div>
                    <div><strong>Length:</strong> 450m</div>
                </div>
                <div class="gps-status">
                    <div class="gps-indicator"></div>
                    <span>GPS: 28.6139°N, 77.2090°E • Accuracy: ±2m</span>
                </div>
            </div>

            <!-- Progress Bar -->
            <div style="padding: 0 16px;">
                <div class="progress-text">Inspection Progress</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <!-- Offline Indicator -->
            <div class="offline-indicator" id="offlineIndicator">
                📱 Working Offline - Data will sync when online
            </div>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-button active" onclick="showTab('structural')">Structural</button>
                <button class="tab-button" onclick="showTab('safety')">Safety</button>
                <button class="tab-button" onclick="showTab('maintenance')">Maintenance</button>
                <button class="tab-button" onclick="showTab('environmental')">Environmental</button>
            </div>

            <!-- Form Container -->
            <div class="form-container">
                <!-- Structural Inspection Tab -->
                <div class="tab-content active" id="structural">
                    <div class="section">
                        <div class="section-header">
                            🏗️ Structural Integrity Assessment
                        </div>

                        <div class="form-group">
                            <label class="form-label">Overall Structural Condition <span class="required">*</span></label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="struct_excellent" name="structural_condition" value="excellent" class="radio-input">
                                    <label for="struct_excellent" class="radio-label">Excellent</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="struct_good" name="structural_condition" value="good" class="radio-input">
                                    <label for="struct_good" class="radio-label">Good</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="struct_fair" name="structural_condition" value="fair" class="radio-input">
                                    <label for="struct_fair" class="radio-label">Fair</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="struct_poor" name="structural_condition" value="poor" class="radio-input">
                                    <label for="struct_poor" class="radio-label">Poor</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="struct_critical" name="structural_condition" value="critical" class="radio-input">
                                    <label for="struct_critical" class="radio-label">Critical</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Structural Issues Observed</label>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="cracks" name="structural_issues" value="cracks">
                                    <label for="cracks">Visible cracks in concrete/steel</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="corrosion" name="structural_issues" value="corrosion">
                                    <label for="corrosion">Steel corrosion or rust</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="spalling" name="structural_issues" value="spalling">
                                    <label for="spalling">Concrete spalling</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="displacement" name="structural_issues" value="displacement">
                                    <label for="displacement">Structural displacement</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="deformation" name="structural_issues" value="deformation">
                                    <label for="deformation">Beam/girder deformation</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Structural Photos <span class="required">*</span></label>
                            <div class="photo-requirement">
                                <div class="requirement-icon" id="struct-overall-icon">4</div>
                                <span>Overall bridge structure (4 photos minimum)</span>
                            </div>
                            <div class="image-capture-area" onclick="captureImage('structural-overall')">
                                <div class="capture-icon">📷</div>
                                <div class="capture-text">Capture Overall Structure</div>
                                <div class="capture-hint">Multiple angles required</div>
                            </div>
                            <div class="captured-images" id="structural-overall-images"></div>
                        </div>

                        <div class="form-group">
                            <div class="photo-requirement">
                                <div class="requirement-icon" id="struct-detail-icon">6</div>
                                <span>Structural details & defects (if any)</span>
                            </div>
                            <div class="image-capture-area" onclick="captureImage('structural-details')">
                                <div class="capture-icon">🔍</div>
                                <div class="capture-text">Capture Structural Details</div>
                                <div class="capture-hint">Focus on joints, supports, defects</div>
                            </div>
                            <div class="captured-images" id="structural-details-images"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Maximum Crack Width (if applicable)</label>
                            <div class="measurement-group">
                                <input type="number" class="form-input" step="0.1" placeholder="Enter measurement">
                                <div class="unit-label">mm</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Structural Assessment Notes</label>
                            <textarea class="form-input" rows="3" placeholder="Detailed observations about structural condition..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Safety Features Tab -->
                <div class="tab-content" id="safety">
                    <div class="section">
                        <div class="section-header">
                            🛡️ Safety Features & Systems
                        </div>

                        <div class="form-group">
                            <label class="form-label">Guard Rails/Barriers Condition <span class="required">*</span></label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="safety_excellent" name="safety_condition" value="excellent" class="radio-input">
                                    <label for="safety_excellent" class="radio-label">Excellent</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="safety_good" name="safety_condition" value="good" class="radio-input">
                                    <label for="safety_good" class="radio-label">Good</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="safety_fair" name="safety_condition" value="fair" class="radio-input">
                                    <label for="safety_fair" class="radio-label">Fair</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="safety_poor" name="safety_condition" value="poor" class="radio-input">
                                    <label for="safety_poor" class="radio-label">Poor</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Safety Features Status</label>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="guardrails_ok" name="safety_features" value="guardrails_ok">
                                    <label for="guardrails_ok">Guard rails intact and secure</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="lighting_working" name="safety_features" value="lighting_working">
                                    <label for="lighting_working">Street lighting functional</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="signs_visible" name="safety_features" value="signs_visible">
                                    <label for="signs_visible">Warning signs clearly visible</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="emergency_access" name="safety_features" value="emergency_access">
                                    <label for="emergency_access">Emergency access available</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="reflectors_ok" name="safety_features" value="reflectors_ok">
                                    <label for="reflectors_ok">Reflectors/markers in place</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Safety Feature Photos <span class="required">*</span></label>
                            <div class="photo-requirement">
                                <div class="requirement-icon" id="safety-barriers-icon">2</div>
                                <span>Guard rails and barriers (both sides)</span>
                            </div>
                            <div class="image-capture-area" onclick="captureImage('safety-barriers')">
                                <div class="capture-icon">🛡️</div>
                                <div class="capture-text">Capture Safety Barriers</div>
                                <div class="capture-hint">Both sides of bridge</div>
                            </div>
                            <div class="captured-images" id="safety-barriers-images"></div>
                        </div>

                        <div class="form-group">
                            <div class="photo-requirement">
                                <div class="requirement-icon" id="safety-signs-icon">2</div>
                                <span>Warning signs and lighting</span>
                            </div>
                            <div class="image-capture-area" onclick="captureImage('safety-signs')">
                                <div class="capture-icon">⚠️</div>
                                <div class="capture-text">Capture Signs & Lighting</div>
                                <div class="capture-hint">All warning signs and lights</div>
                            </div>
                            <div class="captured-images" id="safety-signs-images"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Pedestrian Walkway Condition</label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="walkway_excellent" name="walkway_condition" value="excellent" class="radio-input">
                                    <label for="walkway_excellent" class="radio-label">Excellent</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="walkway_good" name="walkway_condition" value="good" class="radio-input">
                                    <label for="walkway_good" class="radio-label">Good</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="walkway_fair" name="walkway_condition" value="fair" class="radio-input">
                                    <label for="walkway_fair" class="radio-label">Fair</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="walkway_na" name="walkway_condition" value="na" class="radio-input">
                                    <label for="walkway_na" class="radio-label">N/A</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Safety Assessment Notes</label>
                            <textarea class="form-input" rows="3" placeholder="Safety concerns, recommendations, immediate hazards..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Maintenance Tab -->
                <div class="tab-content" id="maintenance">
                    <div class="section">
                        <div class="section-header">
                            🔧 Maintenance & Surface Condition
                        </div>

                        <div class="form-group">
                            <label class="form-label">Road Surface Condition <span class="required">*</span></label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="surface_excellent" name="surface_condition" value="excellent" class="radio-input">
                                    <label for="surface_excellent" class="radio-label">Excellent</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="surface_good" name="surface_condition" value="good" class="radio-input">
                                    <label for="surface_good" class="radio-label">Good</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="surface_fair" name="surface_condition" value="fair" class="radio-input">
                                    <label for="surface_fair" class="radio-label">Fair</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="surface_poor" name="surface_condition" value="poor" class="radio-input">
                                    <label for="surface_poor" class="radio-label">Poor</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Surface Issues Observed</label>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="potholes" name="surface_issues" value="potholes">
                                    <label for="potholes">Potholes present</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="rutting" name="surface_issues" value="rutting">
                                    <label for="rutting">Rutting or depressions</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="cracking_surface" name="surface_issues" value="cracking">
                                    <label for="cracking_surface">Surface cracking</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="loose_material" name="surface_issues" value="loose_material">
                                    <label for="loose_material">Loose aggregate/debris</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="water_pooling" name="surface_issues" value="water_pooling">
                                    <label for="water_pooling">Water pooling/drainage issues</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Road Surface Photos <span class="required">*</span></label>
                            <div class="photo-requirement">
                                <div class="requirement-icon" id="surface-overall-icon">3</div>
                                <span>Overall surface condition</span>
                            </div>
                            <div class="image-capture-area" onclick="captureImage('surface-overall')">
                                <div class="capture-icon">🛣️</div>
                                <div class="capture-text">Capture Road Surface</div>
                                <div class="capture-hint">Full width and length coverage</div>
                            </div>
                            <div class="captured-images" id="surface-overall-images"></div>
                        </div>

                        <div class="form-group">
                            <div class="photo-requirement">
                                <div class="requirement-icon" id="surface-defects-icon">4</div>
                                <span>Surface defects and problem areas</span>
                            </div>
                            <div class="image-capture-area" onclick="captureImage('surface-defects')">
                                <div class="capture-icon">⚠️</div>
                                <div class="capture-text">Capture Surface Defects</div>
                                <div class="capture-hint">Potholes, cracks, drainage issues</div>
                            </div>
                            <div class="captured-images" id="surface-defects-images"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Drainage System Condition</label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="drainage_excellent" name="drainage_condition" value="excellent" class="radio-input">
                                    <label for="drainage_excellent" class="radio-label">Excellent</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="drainage_good" name="drainage_condition" value="good" class="radio-input">
                                    <label for="drainage_good" class="radio-label">Good</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="drainage_poor" name="drainage_condition" value="poor" class="radio-input">
                                    <label for="drainage_poor" class="radio-label">Poor</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="drainage_blocked" name="drainage_condition" value="blocked" class="radio-input">
                                    <label for="drainage_blocked" class="radio-label">Blocked</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Maintenance Priority Level</label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="priority_routine" name="maintenance_priority" value="routine" class="radio-input">
                                    <label for="priority_routine" class="radio-label">Routine</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="priority_minor" name="maintenance_priority" value="minor" class="radio-input">
                                    <label for="priority_minor" class="radio-label">Minor</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="priority_major" name="maintenance_priority" value="major" class="radio-input">
                                    <label for="priority_major" class="radio-label">Major</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="priority_urgent" name="maintenance_priority" value="urgent" class="radio-input">
                                    <label for="priority_urgent" class="radio-label">Urgent</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Maintenance Recommendations</label>
                            <textarea class="form-input" rows="3" placeholder="Specific maintenance actions needed, timeline, materials required..."></textarea>
                        </div>
                    </div>
                </div>

                <!-- Environmental Tab -->
                <div class="tab-content" id="environmental">
                    <div class="section">
                        <div class="section-header">
                            🌿 Environmental & External Factors
                        </div>

                        <div class="form-group">
                            <label class="form-label">Weather Conditions During Inspection <span class="required">*</span></label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="weather_clear" name="weather_condition" value="clear" class="radio-input">
                                    <label for="weather_clear" class="radio-label">Clear</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="weather_cloudy" name="weather_condition" value="cloudy" class="radio-input">
                                    <label for="weather_cloudy" class="radio-label">Cloudy</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="weather_rainy" name="weather_condition" value="rainy" class="radio-input">
                                    <label for="weather_rainy" class="radio-label">Rainy</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="weather_foggy" name="weather_condition" value="foggy" class="radio-input">
                                    <label for="weather_foggy" class="radio-label">Foggy</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Environmental Factors</label>
                            <div class="checkbox-group">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="vegetation_growth" name="environmental_factors" value="vegetation">
                                    <label for="vegetation_growth">Excessive vegetation growth</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="water_damage" name="environmental_factors" value="water_damage">
                                    <label for="water_damage">Water damage/staining</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="erosion" name="environmental_factors" value="erosion">
                                    <label for="erosion">Soil erosion around foundations</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="debris_accumulation" name="environmental_factors" value="debris">
                                    <label for="debris_accumulation">Debris accumulation</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="animal_activity" name="environmental_factors" value="animals">
                                    <label for="animal_activity">Animal nesting/damage</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Environmental Photos</label>
                            <div class="photo-requirement">
                                <div class="requirement-icon" id="env-context-icon">2</div>
                                <span>Environmental context (surroundings)</span>
                            </div>
                            <div class="image-capture-area" onclick="captureImage('environmental-context')">
                                <div class="capture-icon">🌍</div>
                                <div class="capture-text">Capture Environment</div>
                                <div class="capture-hint">Water bodies, vegetation, terrain</div>
                            </div>
                            <div class="captured-images" id="environmental-context-images"></div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Traffic Volume Assessment</label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="traffic_light" name="traffic_volume" value="light" class="radio-input">
                                    <label for="traffic_light" class="radio-label">Light</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="traffic_moderate" name="traffic_volume" value="moderate" class="radio-input">
                                    <label for="traffic_moderate" class="radio-label">Moderate</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="traffic_heavy" name="traffic_volume" value="heavy" class="radio-input">
                                    <label for="traffic_heavy" class="radio-label">Heavy</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="traffic_congested" name="traffic_volume" value="congested" class="radio-input">
                                    <label for="traffic_congested" class="radio-label">Congested</label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Nearby Construction/Activities</label>
                            <textarea class="form-input" rows="2" placeholder="Any ongoing construction, industrial activities, or environmental concerns..."></textarea>
                        </div>
                    </div>

                    <!-- Final Assessment Section -->
                    <div class="section">
                        <div class="section-header">
                            📋 Final Assessment & Sign-off
                        </div>

                        <div class="form-group">
                            <label class="form-label">Overall Bridge Health Score <span class="required">*</span></label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="health_excellent" name="overall_health" value="excellent" class="radio-input">
                                    <label for="health_excellent" class="radio-label">Excellent<br><small>90-100%</small></label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="health_good" name="overall_health" value="good" class="radio-input">
                                    <label for="health_good" class="radio-label">Good<br><small>75-89%</small></label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="health_fair" name="overall_health" value="fair" class="radio-input">
                                    <label for="health_fair" class="radio-label">Fair<br><small>60-74%</small></label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="health_poor" name="overall_health" value="poor" class="radio-input">
                                    <label for="health_poor" class="radio-label">Poor<br><small>40-59%</small></label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="health_critical" name="overall_health" value="critical" class="radio-input">
                                    <label for="health_critical" class="radio-label">Critical<br><small><40%</small></label>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Immediate Action Required?</label>
                            <div class="radio-group">
                                <div class="radio-option">
                                    <input type="radio" id="action_none" name="immediate_action" value="none" class="radio-input">
                                    <label for="action_none" class="radio-label">No Action</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="action_monitoring" name="immediate_action" value="monitoring" class="radio-input">
                                    <label for="action_monitoring" class="radio-label">Monitoring</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="action_maintenance" name="immediate_action" value="maintenance" class="radio-input">
                                    <label for="action_maintenance" class="radio-label">Maintenance</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="action_urgent" name="immediate_action" value="urgent" class="radio-input">
                                    <label for="action_urgent" class="radio-label">Urgent Repair</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="action_closure" name="immediate_action" value="closure" class="radio-input">
                                    <label for="action_closure" class="radio-label">Bridge Closure</label>
                                </div>
                            </div>
                        </div>

                        <div class="warning-alert" id="criticalAlert" style="display: none;">
                            ⚠️ <strong>Critical Condition Detected!</strong><br>
                            Emergency notification will be sent to supervisors immediately upon submission.
                        </div>

                        <div class="form-group">
                            <label class="form-label">Inspector's Summary & Recommendations <span class="required">*</span></label>
                            <textarea class="form-input" rows="4" placeholder="Comprehensive summary of findings, priority recommendations, and any safety concerns..."></textarea>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Digital Signature <span class="required">*</span></label>
                            <canvas class="signature-pad" id="signaturePad" width="327" height="150" style="width: 100%; height: 150px;"></canvas>
                            <div style="display: flex; gap: 8px; margin-top: 8px;">
                                <button class="btn btn-secondary" style="flex: none; padding: 6px 12px;" onclick="clearSignature()">Clear</button>
                                <div style="flex: 1; font-size: 12px; color: #64748b; padding: 6px 0;">Sign above to certify inspection accuracy</div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">Inspector Badge/ID Photo <span class="required">*</span></label>
                            <div class="image-capture-area" onclick="captureImage('inspector-id')">
                                <div class="capture-icon">🆔</div>
                                <div class="capture-text">Capture Inspector ID</div>
                                <div class="capture-hint">For verification and authentication</div>
                            </div>
                            <div class="captured-images" id="inspector-id-images"></div>
                        </div>

                        <div class="success-alert" id="validationSuccess" style="display: none;">
                            ✅ <strong>All Requirements Met!</strong><br>
                            Ready for submission. Data will sync automatically.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Action Buttons -->
            <div class="bottom-actions">
                <button class="btn btn-secondary" onclick="saveDraft()">💾 Save Draft</button>
                <button class="btn btn-primary" onclick="submitInspection()" id="submitBtn" disabled>📤 Submit Report</button>
            </div>
        </div>
    </div>

    <script>
        let currentTab = 'structural';
        let capturedImages = {
            'structural-overall': [],
            'structural-details': [],
            'safety-barriers': [],
            'safety-signs': [],
            'surface-overall': [],
            'surface-defects': [],
            'environmental-context': [],
            'inspector-id': []
        };
        let signatureData = null;
        let isOnline = navigator.onLine;

        // Tab switching functionality
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab button
            event.target.classList.add('active');
            
            currentTab = tabName;
            updateProgress();
        }

        // Image capture simulation
        function captureImage(category) {
            // Simulate camera capture
            const imageCount = capturedImages[category].length + 1;
            const imageName = `${category}_${imageCount}.jpg`;
            
            capturedImages[category].push({
                name: imageName,
                timestamp: new Date().toISOString(),
                gps: "28.6139°N, 77.2090°E"
            });
            
            // Update the display
            updateImageDisplay(category);
            updatePhotoRequirements(category);
            updateProgress();
            
            // Vibration feedback for mobile
            if (navigator.vibrate) {
                navigator.vibrate(50);
            }
        }

        // Update image display
        function updateImageDisplay(category) {
            const container = document.getElementById(`${category}-images`);
            const images = capturedImages[category];
            
            container.innerHTML = '';
            images.forEach((image, index) => {
                const imageDiv = document.createElement('div');
                imageDiv.className = 'captured-image';
                imageDiv.innerHTML = `
                    <div style="font-size: 10px; text-align: center;">
                        📷 ${image.name}<br>
                        <small>${new Date(image.timestamp).toLocaleTimeString()}</small>
                    </div>
                    <button class="remove-image" onclick="removeImage('${category}', ${index})">×</button>
                `;
                container.appendChild(imageDiv);
            });
        }

        // Remove captured image
        function removeImage(category, index) {
            capturedImages[category].splice(index, 1);
            updateImageDisplay(category);
            updatePhotoRequirements(category);
            updateProgress();
        }

        // Update photo requirement indicators
        function updatePhotoRequirements(category) {
            const requirements = {
                'structural-overall': 4,
                'structural-details': 6,
                'safety-barriers': 2,
                'safety-signs': 2,
                'surface-overall': 3,
                'surface-defects': 4,
                'environmental-context': 2,
                'inspector-id': 1
            };
            
            const iconId = category.replace('-', '-').split('-');
            iconId[iconId.length - 1] = 'icon';
            const iconElement = document.getElementById(iconId.join('-'));
            
            if (iconElement) {
                const captured = capturedImages[category].length;
                const required = requirements[category];
                
                if (captured >= required) {
                    iconElement.classList.add('completed');
                    iconElement.textContent = '✓';
                } else {
                    iconElement.classList.remove('completed');
                    iconElement.textContent = required - captured;
                }
            }
        }

        // Progress calculation
        function updateProgress() {
            const totalSections = 4;
            let completedSections = 0;
            
            // Check each section completion
            const sections = ['structural', 'safety', 'maintenance', 'environmental'];
            sections.forEach(section => {
                if (isSectionComplete(section)) {
                    completedSections++;
                }
            });
            
            const progressPercentage = (completedSections / totalSections) * 100;
            document.getElementById('progressFill').style.width = progressPercentage + '%';
            
            // Check if ready to submit
            const allRequiredFieldsFilled = checkAllRequiredFields();
            const submitBtn = document.getElementById('submitBtn');
            
            if (allRequiredFieldsFilled) {
                submitBtn.disabled = false;
                document.getElementById('validationSuccess').style.display = 'block';
            } else {
                submitBtn.disabled = true;
                document.getElementById('validationSuccess').style.display = 'none';
            }
        }

        // Check if section is complete
        function isSectionComplete(section) {
            const requiredFields = getRequiredFieldsForSection(section);
            return requiredFields.every(field => {
                const input = document.querySelector(`[name="${field}"]`);
                if (input) {
                    if (input.type === 'radio') {
                        return document.querySelector(`[name="${field}"]:checked`) !== null;
                    }
                    return input.value.trim() !== '';
                }
                return false;
            });
        }

        // Get required fields for each section
        function getRequiredFieldsForSection(section) {
            const requiredFields = {
                'structural': ['structural_condition'],
                'safety': ['safety_condition'],
                'maintenance': ['surface_condition'],
                'environmental': ['weather_condition', 'overall_health', 'immediate_action']
            };
            return requiredFields[section] || [];
        }

        // Check all required fields
        function checkAllRequiredFields() {
            const allRequired = [
                'structural_condition', 'safety_condition', 'surface_condition',
                'weather_condition', 'overall_health', 'immediate_action'
            ];
            
            const fieldsComplete = allRequired.every(field => {
                const input = document.querySelector(`[name="${field}"]:checked`);
                return input !== null;
            });
            
            // Check photo requirements
            const photoRequirements = {
                'structural-overall': 4,
                'safety-barriers': 2,
                'surface-overall': 3,
                'inspector-id': 1
            };
            
            const photosComplete = Object.keys(photoRequirements).every(category => {
                return capturedImages[category].length >= photoRequirements[category];
            });
            
            // Check signature
            const hasSignature = signatureData !== null;
            
            // Check summary
            const summaryComplete = document.querySelector('textarea[placeholder*="Comprehensive summary"]').value.trim() !== '';
            
            return fieldsComplete && photosComplete && hasSignature && summaryComplete;
        }

        // Signature pad functionality
        function initializeSignaturePad() {
            const canvas = document.getElementById('signaturePad');
            const ctx = canvas.getContext('2d');
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;

            function getEventPos(e) {
                const rect = canvas.getBoundingClientRect();
                const clientX = e.clientX || (e.touches && e.touches[0].clientX);
                const clientY = e.clientY || (e.touches && e.touches[0].clientY);
                return {
                    x: (clientX - rect.left) * (canvas.width / rect.width),
                    y: (clientY - rect.top) * (canvas.height / rect.height)
                };
            }

            function startDrawing(e) {
                isDrawing = true;
                const pos = getEventPos(e);
                [lastX, lastY] = [pos.x, pos.y];
                e.preventDefault();
            }

            function draw(e) {
                if (!isDrawing) return;
                
                const pos = getEventPos(e);
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(pos.x, pos.y);
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.stroke();
                
                [lastX, lastY] = [pos.x, pos.y];
                signatureData = canvas.toDataURL();
                updateProgress();
                e.preventDefault();
            }

            function stopDrawing() {
                isDrawing = false;
            }

            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);

            // Touch events
            canvas.addEventListener('touchstart', startDrawing);
            canvas.addEventListener('touchmove', draw);
            canvas.addEventListener('touchend', stopDrawing);
        }

        // Clear signature
        function clearSignature() {
            const canvas = document.getElementById('signaturePad');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            signatureData = null;
            updateProgress();
        }

        // Monitor health score selection for critical alerts
        document.addEventListener('change', function(e) {
            if (e.target.name === 'overall_health' && e.target.value === 'critical') {
                document.getElementById('criticalAlert').style.display = 'block';
            } else if (e.target.name === 'overall_health') {
                document.getElementById('criticalAlert').style.display = 'none';
            }
            updateProgress();
        });

        // Monitor immediate action selection
        document.addEventListener('change', function(e) {
            if (e.target.name === 'immediate_action' && ['urgent', 'closure'].includes(e.target.value)) {
                document.getElementById('criticalAlert').style.display = 'block';
            }
            updateProgress();
        });

        // Save draft functionality
        function saveDraft() {
            const formData = collectFormData();
            localStorage.setItem('bridge_inspection_draft', JSON.stringify({
                ...formData,
                timestamp: new Date().toISOString(),
                bridgeId: 'BRG-001'
            }));
            
            // Show temporary feedback
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '✅ Saved';
            btn.style.background = '#22c55e';
            
            setTimeout(() => {
                btn.innerHTML = originalText;
                btn.style.background = '';
            }, 2000);
        }

        // Submit inspection
        function submitInspection() {
            if (!checkAllRequiredFields()) {
                alert('Please complete all required fields before submitting.');
                return;
            }

            const formData = collectFormData();
            const inspectionReport = {
                ...formData,
                bridgeId: 'BRG-001',
                inspectorId: 'EMP-001',
                inspectorName: 'Anil Kumar',
                submissionTime: new Date().toISOString(),
                gpsCoordinates: "28.6139°N, 77.2090°E",
                capturedImages: capturedImages,
                signature: signatureData,
                appVersion: '2.1.0',
                deviceInfo: navigator.userAgent
            };

            // Show submission progress
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.innerHTML = '📤 Submitting...';
            submitBtn.disabled = true;

            // Simulate submission delay
            setTimeout(() => {
                if (isOnline) {
                    // Online submission
                    submitBtn.innerHTML = '✅ Submitted';
                    submitBtn.style.background = '#22c55e';
                    
                    // Clear draft
                    localStorage.removeItem('bridge_inspection_draft');
                    
                    setTimeout(() => {
                        alert(`Inspection Report Submitted Successfully!

Report ID: RPT-${Date.now()}
Bridge: NH-44 Highway Bridge (BRG-001)
Inspector: Anil Kumar (EMP-001)
Time: ${new Date().toLocaleString()}

Status: Processing for review
Admin notification: Sent

The report will be reviewed by supervisors within 24 hours.`);
                        
                        // Reset form or navigate back
                        if (confirm('Return to bridge list?')) {
                            window.location.reload();
                        }
                    }, 1500);
                } else {
                    // Offline submission - save to queue
                    let offlineQueue = JSON.parse(localStorage.getItem('offline_submissions') || '[]');
                    offlineQueue.push(inspectionReport);
                    localStorage.setItem('offline_submissions', JSON.stringify(offlineQueue));
                    
                    submitBtn.innerHTML = '📱 Queued Offline';
                    submitBtn.style.background = '#f59e0b';
                    
                    alert('Report saved offline and will be submitted when connection is restored.');
                }
            }, 2000);
        }

        // Collect all form data
        function collectFormData() {
            const formData = {};
            
            // Collect all form inputs
            document.querySelectorAll('input, select, textarea').forEach(input => {
                if (input.type === 'radio' && input.checked) {
                    formData[input.name] = input.value;
                } else if (input.type === 'checkbox' && input.checked) {
                    if (!formData[input.name]) formData[input.name] = [];
                    formData[input.name].push(input.value);
                } else if (input.type !== 'radio' && input.type !== 'checkbox') {
                    formData[input.name] = input.value;
                }
            });
            
            return formData;
        }

        // Check online/offline status
        function updateOnlineStatus() {
            isOnline = navigator.onLine;
            const offlineIndicator = document.getElementById('offlineIndicator');
            
            if (!isOnline) {
                offlineIndicator.style.display = 'block';
            } else {
                offlineIndicator.style.display = 'none';
                // Process offline queue
                processOfflineQueue();
            }
        }

        // Process offline submissions when back online
        function processOfflineQueue() {
            const offlineQueue = JSON.parse(localStorage.getItem('offline_submissions') || '[]');
            
            if (offlineQueue.length > 0) {
                console.log(`Processing ${offlineQueue.length} offline submissions...`);
                // In a real app, these would be submitted to the server
                localStorage.removeItem('offline_submissions');
            }
        }

        // Load draft if exists
        function loadDraft() {
            const draft = localStorage.getItem('bridge_inspection_draft');
            if (draft) {
                const draftData = JSON.parse(draft);
                // Restore form data
                Object.keys(draftData).forEach(key => {
                    const input = document.querySelector(`[name="${key}"]`);
                    if (input) {
                        if (input.type === 'radio') {
                            const radioInput = document.querySelector(`[name="${key}"][value="${draftData[key]}"]`);
                            if (radioInput) radioInput.checked = true;
                        } else if (input.type === 'checkbox') {
                            if (Array.isArray(draftData[key])) {
                                draftData[key].forEach(value => {
                                    const checkboxInput = document.querySelector(`[name="${key}"][value="${value}"]`);
                                    if (checkboxInput) checkboxInput.checked = true;
                                });
                            }
                        } else {
                            input.value = draftData[key];
                        }
                    }
                });
                
                // Show notification about loaded draft
                const notification = document.createElement('div');
                notification.className = 'success-alert';
                notification.innerHTML = '📄 Draft loaded from ' + new Date(draftData.timestamp).toLocaleString();
                notification.style.margin = '16px';
                document.querySelector('.form-container').insertBefore(notification, document.querySelector('.section'));
                
                setTimeout(() => notification.remove(), 5000);
                updateProgress();
            }
        }

        // Geolocation verification
        function verifyLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        const accuracy = position.coords.accuracy;
                        
                        // Check if location is within acceptable range of bridge coordinates
                        const bridgeLat = 28.6139;
                        const bridgeLng = 77.2090;
                        const distance = calculateDistance(lat, lng, bridgeLat, bridgeLng);
                        
                        const gpsStatus = document.querySelector('.gps-status');
                        if (distance < 100 && accuracy < 20) { // Within 100m with good accuracy
                            gpsStatus.style.background = 'rgba(34, 197, 94, 0.1)';
                            gpsStatus.style.color = '#166534';
                            gpsStatus.innerHTML = `
                                <div class="gps-indicator"></div>
                                <span>GPS: ${lat.toFixed(6)}°N, ${lng.toFixed(6)}°E • Accuracy: ±${Math.round(accuracy)}m ✓</span>
                            `;
                        } else {
                            gpsStatus.style.background = 'rgba(239, 68, 68, 0.1)';
                            gpsStatus.style.color = '#991b1b';
                            gpsStatus.innerHTML = `
                                <div style="width: 8px; height: 8px; border-radius: 50%; background: #ef4444; margin-right: 6px;"></div>
                                <span>GPS: Location verification failed. Move closer to bridge.</span>
                            `;
                        }
                    },
                    function(error) {
                        const gpsStatus = document.querySelector('.gps-status');
                        gpsStatus.style.background = 'rgba(239, 68, 68, 0.1)';
                        gpsStatus.style.color = '#991b1b';
                        gpsStatus.innerHTML = `
                            <div style="width: 8px; height: 8px; border-radius: 50%; background: #ef4444; margin-right: 6px;"></div>
                            <span>GPS: Unable to access location. Please enable GPS.</span>
                        `;
                    },
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 60000
                    }
                );
            }
        }

        // Calculate distance between two GPS coordinates
        function calculateDistance(lat1, lng1, lat2, lng2) {
            const R = 6371e3; // Earth's radius in meters
            const φ1 = lat1 * Math.PI/180;
            const φ2 = lat2 * Math.PI/180;
            const Δφ = (lat2-lat1) * Math.PI/180;
            const Δλ = (lng2-lng1) * Math.PI/180;

            const a = Math.sin(Δφ/2) * Math.sin(Δφ/2) +
                    Math.cos(φ1) * Math.cos(φ2) *
                    Math.sin(Δλ/2) * Math.sin(Δλ/2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));

            return R * c; // Distance in meters
        }

        // Auto-save functionality
        function enableAutoSave() {
            setInterval(() => {
                const formData = collectFormData();
                if (Object.keys(formData).length > 0) {
                    localStorage.setItem('bridge_inspection_autosave', JSON.stringify({
                        ...formData,
                        timestamp: new Date().toISOString(),
                        capturedImages: capturedImages
                    }));
                }
            }, 30000); // Auto-save every 30 seconds
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Bridge Inspection Mobile App Initialized');
            
            // Initialize components
            initializeSignaturePad();
            verifyLocation();
            loadDraft();
            enableAutoSave();
            updateProgress();
            
            // Set up event listeners
            window.addEventListener('online', updateOnlineStatus);
            window.addEventListener('offline', updateOnlineStatus);
            
            // Initial status check
            updateOnlineStatus();
            
            // Update photo requirements on load
            Object.keys(capturedImages).forEach(category => {
                updatePhotoRequirements(category);
            });
            
            // Show welcome message
            setTimeout(() => {
                console.log('Ready for bridge inspection');
                console.log('Features available:');
                console.log('• GPS location verification');
                console.log('• Offline data storage');
                console.log('• Auto-save functionality');
                console.log('• Digital signature capture');
                console.log('• Photo requirements tracking');
                console.log('• Comprehensive inspection forms');
            }, 1000);
            
            // Simulate initial photo requirements check
            setTimeout(() => {
                updateProgress();
            }, 2000);
        });

        // Prevent form submission on enter key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
            }
        });

        // Handle device orientation changes
        window.addEventListener('orientationchange', function() {
            setTimeout(() => {
                // Recalculate canvas dimensions if needed
                const canvas = document.getElementById('signaturePad');
                if (canvas) {
                    const rect = canvas.getBoundingClientRect();
                    canvas.style.width = rect.width + 'px';
                }
            }, 100);
        });

        // Add haptic feedback for interactions
        function addHapticFeedback() {
            document.addEventListener('click', function(e) {
                if (e.target.matches('.btn, .radio-label, .checkbox-item, .image-capture-area')) {
                    if (navigator.vibrate) {
                        navigator.vibrate(25);
                    }
                }
            });
        }

        // Initialize haptic feedback
        addHapticFeedback();

        // Add voice notes functionality (placeholder)
        function addVoiceNote(section) {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.continuous = false;
                recognition.interimResults = false;
                recognition.lang = 'en-US';
                
                recognition.onresult = function(event) {
                    const transcript = event.results[0][0].transcript;
                    const textarea = document.querySelector(`#${section} textarea`);
                    if (textarea) {
                        textarea.value += (textarea.value ? ' ' : '') + transcript;
                        updateProgress();
                    }
                };
                
                recognition.start();
            }
        }

        // Add timestamp to all form interactions
        document.addEventListener('change', function(e) {
            if (e.target.matches('input, select, textarea')) {
                e.target.setAttribute('data-last-modified', new Date().toISOString());
            }
        });

        // Warning for unsaved changes
        window.addEventListener('beforeunload', function(e) {
            const formData = collectFormData();
            if (Object.keys(formData).length > 0 && !localStorage.getItem('inspection_submitted')) {
                const message = 'You have unsaved inspection data. Are you sure you want to leave?';
                e.returnValue = message;
                return message;
            }
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveDraft();
                        break;
                    case 'Enter':
                        if (e.shiftKey) {
                            e.preventDefault();
                            submitInspection();
                        }
                        break;
                }
            }
        });

        // Add swipe gesture support for tab navigation
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > swipeThreshold) {
                const tabs = ['structural', 'safety', 'maintenance', 'environmental'];
                const currentIndex = tabs.indexOf(currentTab);
                
                if (diff > 0 && currentIndex < tabs.length - 1) {
                    // Swipe left - next tab
                    showTab(tabs[currentIndex + 1]);
                } else if (diff < 0 && currentIndex > 0) {
                    // Swipe right - previous tab
                    showTab(tabs[currentIndex - 1]);
                }
            }
        }

        // Add accessibility improvements
        function initializeAccessibility() {
            // Add ARIA labels
            document.querySelectorAll('.form-label').forEach(label => {
                const input = label.nextElementSibling;
                if (input && input.tagName === 'INPUT') {
                    input.setAttribute('aria-label', label.textContent);
                }
            });
            
            // Add focus management
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Tab') {
                    // Ensure proper tab order
                    const focusableElements = document.querySelectorAll(
                        'button, input, select, textarea, [tabindex]:not([tabindex="-1"])'
                    );
                    
                    const firstElement = focusableElements[0];
                    const lastElement = focusableElements[focusableElements.length - 1];
                    
                    if (e.shiftKey && document.activeElement === firstElement) {
                        e.preventDefault();
                        lastElement.focus();
                    } else if (!e.shiftKey && document.activeElement === lastElement) {
                        e.preventDefault();
                        firstElement.focus();
                    }
                }
            });
        }

        // Initialize accessibility features
        initializeAccessibility();

        // Add performance monitoring
        function monitorPerformance() {
            // Track form completion time
            const startTime = Date.now();
            
            window.addEventListener('beforeunload', function() {
                const completionTime = (Date.now() - startTime) / 1000;
                localStorage.setItem('last_inspection_duration', completionTime);
            });
            
            // Track app performance
            if ('performance' in window) {
                window.addEventListener('load', function() {
                    setTimeout(() => {
                        const perfData = performance.getEntriesByType('navigation')[0];
                        console.log('App load time:', perfData.loadEventEnd - perfData.loadEventStart, 'ms');
                    }, 0);
                });
            }
        }

        monitorPerformance();
    </script>
</body>
</html>